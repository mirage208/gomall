# 项目K8s部署文档

> 参考：https://go-zero.dev/docs/tutorials/ops/k8s

### 1. 为项目创建`Namespace`
```shell
kubectl create namespace go-mall
```

### 2. 为命名空间创建`find-endpoints`账号并配置权限
go-zero 在 K8s 中部署时不再使用 `etcd` 作为服务注册/发现中心，而是使用 K8s 的 Service，此时需要为生成的 K8s yml 指定 `serviceAccount`。

所以需要在 K8s 中创建 `find-endpoints` 这个 `serviceAccount` 并绑定相应权限。

只需要执行：
```shell
kubectl apply -f auth.yml # auth.yml 文件如下：
```

```yaml
#创建账号
apiVersion: v1
kind: ServiceAccount
metadata:
  namespace: go-mall
  name: find-endpoints

---
#创建角色对应操作
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: discov-endpoints
rules:
  - apiGroups: [""]
    resources: ["endpoints"]
    verbs: ["get", "list", "watch"]

---
#给账号绑定角色
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: find-endpoints-discov-endpoints
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: discov-endpoints
subjects:
  - kind: ServiceAccount
    name: find-endpoints
    namespace: go-mall
```